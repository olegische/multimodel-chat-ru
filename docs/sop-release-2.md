# SOP: Процедура релиза 2.0 (GigaChat Integration)

## 1. Подготовка к релизу

### 1.1. Настройка GigaChat API
- [ ] Получение доступа к GigaChat API
- [ ] Создание и настройка учетных данных
- [ ] Обновление .env.example и .env с новыми переменными для GigaChat
- [ ] Тестирование подключения к API

### 1.2. Рефакторинг API слоя
- [ ] Создание абстрактного интерфейса для LLM провайдеров
- [ ] Рефакторинг YandexGPT сервиса под новый интерфейс
- [ ] Реализация GigaChat сервиса
- [ ] Создание фабрики для выбора провайдера

### 1.3. Обновление базы данных
- [ ] Добавление поля provider в схему сообщений
- [ ] Создание миграций Prisma
- [ ] Обновление типов TypeScript

## 2. Разработка

### 2.1. Backend
- [ ] Реализация GigaChat API интеграции:
  - [ ] Аутентификация
  - [ ] Обработка запросов
  - [ ] Обработка ошибок
- [ ] Обновление API endpoints:
  - [ ] Поддержка выбора провайдера
  - [ ] Обработка markdown в ответах
- [ ] Реализация конвертации форматов ответов

### 2.2. Frontend
- [ ] Обновление компонента Header:
  - [ ] Добавление селектора провайдера
  - [ ] Отображение доступных моделей
- [ ] Обновление Chat Window:
  - [ ] Добавление поддержки markdown
  - [ ] Интеграция подсветки синтаксиса
  - [ ] Стилизация форматированного текста
- [ ] Добавление индикатора загрузки
- [ ] Реализация копирования в буфер обмена

### 2.3. Интеграция markdown
- [ ] Выбор и установка библиотеки для рендеринга markdown
- [ ] Настройка стилей для markdown-контента
- [ ] Настройка подсветки синтаксиса для блоков кода
- [ ] Тестирование различных форматов markdown

## 3. Тестирование

### 3.1. Модульное тестирование
- [ ] Тестирование GigaChat сервиса
- [ ] Тестирование фабрики провайдеров
- [ ] Тестирование обработки markdown
- [ ] Тестирование обновленных API endpoints

### 3.2. Интеграционное тестирование
- [ ] Тестирование переключения между провайдерами
- [ ] Тестирование сохранения контекста
- [ ] Тестирование рендеринга markdown
- [ ] Проверка производительности

### 3.3. Пользовательское тестирование
- [ ] Проверка UI/UX с разными провайдерами
- [ ] Тестирование форматированных ответов
- [ ] Проверка копирования в буфер обмена
- [ ] Тестирование на разных устройствах

## 4. Развертывание

### 4.1. Подготовка к развертыванию
- [ ] Обновление Dockerfile
- [ ] Обновление скриптов развертывания
- [ ] Проверка переменных окружения
- [ ] Тестирование сборки

### 4.2. Обновление документации
- [ ] Обновление README.md
- [ ] Документация по GigaChat API
- [ ] Обновление инструкций по развертыванию
- [ ] Документация по работе с markdown

### 4.3. Развертывание
- [ ] Создание резервной копии базы данных
- [ ] Применение миграций
- [ ] Развертывание обновленного приложения
- [ ] Проверка работоспособности

## 5. Критерии готовности релиза

### 5.1. Функциональные критерии
- [ ] Работает интеграция с GigaChat API
- [ ] Корректно переключаются провайдеры
- [ ] Правильно отображается markdown
- [ ] Работает копирование в буфер обмена

### 5.2. Технические критерии
- [ ] Все тесты проходят успешно
- [ ] Миграции применяются корректно
- [ ] Производительность соответствует требованиям
- [ ] Логирование работает корректно

### 5.3. Документационные критерии
- [ ] Документация актуализирована
- [ ] API документация обновлена
- [ ] Инструкции по развертыванию проверены
- [ ] Добавлены примеры использования новых функций

## 6. Действия после релиза

### 6.1. Мониторинг
- [ ] Проверка логов на наличие ошибок
- [ ] Мониторинг производительности
- [ ] Отслеживание использования API провайдеров

### 6.2. Поддержка
- [ ] Сбор обратной связи от пользователей
- [ ] Исправление обнаруженных проблем
- [ ] Подготовка к релизу 2.1 